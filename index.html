<!DOCTYPE html>
<html lang="sw">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dr. William Herbal · Prescription</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&family=Cinzel:wght@700&family=Playfair+Display:ital,wght@0,400;0,700;1,400&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script crossorigin src="https://unpkg.com/react@18.2.0/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18.2.0/umd/react-dom.development.js"></script>

    <style>
        body { font-family: 'Poppins', sans-serif; background: #f0f4f0; }
        .font-cinzel { font-family: 'Cinzel', serif; }
        
        /* Auto-expand Logic */
        .expanding-textarea {
            resize: none;
            overflow: hidden;
            min-height: 1.5rem;
            display: block;
            width: 100%;
        }

        /* PRINT STYLES - Hapa ndipo uchawi wa kuonekana maandishi yote ulipo */
        @media print {
            .no-print { display: none !important; }
            body { background: white !important; }
            #prescription-paper {
                box-shadow: none !important;
                width: 100% !important;
                margin: 0 !important;
                padding: 1cm !important;
                height: auto !important;
            }
            .expanding-textarea {
                border: none !important;
                overflow: visible !important;
                height: auto !important;
                white-space: pre-wrap !important; /* Inaruhusu mistari mipya */
                word-wrap: break-word !important;
            }
            .med-table th { background-color: #f8fafc !important; -webkit-print-color-adjust: exact; }
            @page { size: A4; margin: 1cm; }
        }

        #prescription-paper {
            background: white;
            min-height: 297mm; /* A4 height */
            width: 210mm;      /* A4 width */
            margin: 20px auto;
            padding: 40px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.1);
            position: relative;
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script>
        const { useState, useEffect, useRef, useCallback } = React;

        // Component ya Textarea inayojitanua yenyewe
        const AutoTextarea = ({ value, onChange, placeholder, className = "" }) => {
            const areaRef = useRef(null);

            const adjustHeight = () => {
                const element = areaRef.current;
                if (element) {
                    element.style.height = "auto"; // Reset height
                    element.style.height = element.scrollHeight + "px"; // Set to content height
                }
            };

            useEffect(() => {
                adjustHeight();
            }, [value]);

            return React.createElement('textarea', {
                ref: areaRef,
                value: value,
                placeholder: placeholder,
                onChange: (e) => {
                    onChange(e.target.value);
                    adjustHeight();
                },
                className: `expanding-textarea focus:ring-0 outline-none transition-all ${className}`,
                rows: 1
            });
        };

        const App = () => {
            const [data, setData] = useState({
                patientName: '',
                ageGender: '',
                date: new Date().toISOString().split('T')[0],
                address: '',
                meds: [{ id: 1, name: '', dose: '', info: '' }],
                notes: ''
            });

            const updateMed = (id, field, val) => {
                const newMeds = data.meds.map(m => m.id === id ? { ...m, [field]: val } : m);
                setData({ ...data, meds: newMeds });
            };

            const addRow = () => setData({ ...data, meds: [...data.meds, { id: Date.now(), name: '', dose: '', info: '' }] });

            return React.createElement('div', { className: "min-h-screen py-8" },
                // Print Button
                React.createElement('div', { className: "flex justify-center mb-6 no-print gap-4" },
                    React.createElement('button', { 
                        onClick: () => window.print(),
                        className: "bg-green-700 text-white px-6 py-2 rounded-full hover:bg-green-800 transition-all flex items-center gap-2 shadow-lg"
                    }, React.createElement('i', { className: "fas fa-print" }), "Print Prescription")
                ),

                // Karatasi ya Prescription
                React.createElement('div', { id: "prescription-paper" },
                    // Header
                    React.createElement('div', { className: "text-center border-b-2 border-green-800 pb-4 mb-6" },
                        React.createElement('h1', { className: "font-cinzel text-3xl text-green-900 font-bold" }, "DR. WILLIAM HERBAL CLINIC"),
                        React.createElement('p', { className: "text-xs italic text-slate-600" }, "Tiba Asili na Ushauri wa Kiafya · Dar es Salaam, Tanzania"),
                        React.createElement('div', { className: "flex justify-center gap-6 mt-2 text-[10px] font-semibold text-slate-700" },
                            React.createElement('span', null, React.createElement('i', { className: "fas fa-phone mr-1" }), "+255 7XX XXX XXX"),
                            React.createElement('span', null, React.createElement('i', { className: "fas fa-envelope mr-1" }), "info@drwilliamherbal.com")
                        )
                    ),

                    // Patient Info Section
                    React.createElement('div', { className: "grid grid-cols-2 gap-4 mb-8 text-sm" },
                        React.createElement('div', { className: "space-y-2" },
                            React.createElement('div', { className: "flex border-b border-dotted border-slate-300" },
                                React.createElement('span', { className: "font-bold w-20" }, "Name:"),
                                React.createElement(AutoTextarea, { value: data.patientName, onChange: (v) => setData({...data, patientName: v}), placeholder: "Jina la Mgonjwa", className: "font-medium" })
                            ),
                            React.createElement('div', { className: "flex border-b border-dotted border-slate-300" },
                                React.createElement('span', { className: "font-bold w-20" }, "Address:"),
                                React.createElement(AutoTextarea, { value: data.address, onChange: (v) => setData({...data, address: v}), placeholder: "Mahali anapoishi" })
                            )
                        ),
                        React.createElement('div', { className: "space-y-2" },
                            React.createElement('div', { className: "flex border-b border-dotted border-slate-300" },
                                React.createElement('span', { className: "font-bold w-20" }, "Date:"),
                                React.createElement('input', { type: "date", value: data.date, onChange: (e) => setData({...data, date: e.target.value}), className: "w-full outline-none bg-transparent" })
                            ),
                            React.createElement('div', { className: "flex border-b border-dotted border-slate-300" },
                                React.createElement('span', { className: "font-bold w-20" }, "Age/Sex:"),
                                React.createElement(AutoTextarea, { value: data.ageGender, onChange: (v) => setData({...data, ageGender: v}), placeholder: "Miaka / Jinsia" })
                            )
                        )
                    ),

                    // Rx Symbol
                    React.createElement('div', { className: "text-4xl font-playfair italic mb-4 text-green-900" }, "Rx"),

                    // Medication Table
                    React.createElement('table', { className: "w-full text-left border-collapse mb-8 text-sm med-table" },
                        React.createElement('thead', null,
                            React.createElement('tr', { className: "bg-slate-50 border-y-2 border-green-800" },
                                React.createElement('th', { className: "py-2 px-3 w-1/3" }, "Jina la Dawa"),
                                React.createElement('th', { className: "py-2 px-3 w-1/4" }, "Kipimo (Dosage)"),
                                React.createElement('th', { className: "py-2 px-3" }, "Maelekezo (Instructions)")
                            )
                        ),
                        React.createElement('tbody', null,
                            data.meds.map(med => 
                                React.createElement('tr', { key: med.id, className: "border-b border-slate-100" },
                                    React.createElement('td', { className: "p-1" }, React.createElement(AutoTextarea, { value: med.name, onChange: (v) => updateMed(med.id, 'name', v), placeholder: "Dawa...", className: "font-semibold" })),
                                    React.createElement('td', { className: "p-1" }, React.createElement(AutoTextarea, { value: med.dose, onChange: (v) => updateMed(med.id, 'dose', v), placeholder: "Mf: 2x3" })),
                                    React.createElement('td', { className: "p-1" }, React.createElement(AutoTextarea, { value: med.info, onChange: (v) => updateMed(med.id, 'info', v), placeholder: "Maelekezo ya ziada..." }))
                                )
                            )
                        )
                    ),

                    // Add Row Button
                    React.createElement('button', { 
                        onClick: addRow,
                        className: "no-print text-green-700 text-xs font-bold mb-8 hover:underline"
                    }, "+ Ongeza Dawa Nyingine"),

                    // Doctor Notes Section
                    React.createElement('div', { className: "mt-10" },
                        React.createElement('h3', { className: "font-bold text-green-800 border-b border-green-800 mb-2" }, "DOCTOR'S ADVICE / NOTES:"),
                        React.createElement(AutoTextarea, { 
                            value: data.notes, 
                            onChange: (v) => setData({...data, notes: v}), 
                            placeholder: "Andika ushauri au maelezo ya ziada hapa...",
                            className: "italic text-slate-700 min-h-[150px]" 
                        })
                    ),

                    // Footer Signature
                    React.createElement('div', { className: "mt-20 flex justify-end" },
                        React.createElement('div', { className: "text-center w-48" },
                            React.createElement('div', { className: "border-b-2 border-slate-400 mb-2" }),
                            React.createElement('p', { className: "font-bold text-xs" }, "Dr. William"),
                            React.createElement('p', { className: "text-[10px] text-slate-500" }, "Authorized Herbalist")
                        )
                    ),

                    // Stamp Space
                    React.createElement('div', { className: "absolute bottom-10 left-10 opacity-10 no-print" },
                        React.createElement('i', { className: "fas fa-certificate text-8xl text-green-900" })
                    )
                )
            );
        };

        ReactDOM.render(React.createElement(App), document.getElementById('root'));
    </script>
</body>
</html>
